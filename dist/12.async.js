(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"7Zm1":function(e,a,t){e.exports={trendItem:"antd-pro-components-trend-index-trendItem",down:"antd-pro-components-trend-index-down",up:"antd-pro-components-trend-index-up",trendItemGrey:"antd-pro-components-trend-index-trendItemGrey",reverseColor:"antd-pro-components-trend-index-reverseColor"}},E6K0:function(e,a,t){"use strict";var d=t("TqRt"),l=t("284h");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("IzEo");var r=d(t("bx4M"));t("14J3");var n=d(t("BMrR"));t("5Dmo");var s=d(t("3S7+"));t("Pwec");var i=d(t("CtXQ"));t("jCWc");var o=d(t("kPKH")),u=d(t("MVZn")),c=d(t("lwsE")),f=d(t("W8MJ")),m=d(t("a1gu")),p=d(t("Nsbk")),h=d(t("7W2i"));t("Znn+");var g=d(t("ZTPi"));t("iQDF");var y=d(t("+eQT"));t("OaEy");var v,R,b=d(t("2fM7")),E=l(t("q1tI")),k=t("MuoO"),C=t("LLXN"),I=t("34ay"),x=d(t("ZhIB")),M=(d(t("4IMT")),t("KTCi")),B=d(t("v99g")),D=t("+n12"),w=d(t("YR7N")),T=d(t("rBGm")),N=(t("eHHv"),t("PQp+"),t("1pet"),t("+n12"),d(t("wd/R"))),P=(d(t("fqRC")),b.default.Option,y.default.RangePicker),S={xs:24,sm:12,md:12,lg:12,xl:6,style:{marginBottom:24}},A=(0,I.getAuthority)(),W=g.default.TabPane,F=(v=(0,k.connect)(function(e){var a=e.areas,t=e.dashboard,d=(e.geo,e.loading);e.chart;return{dashboard:t,selectedAreaId:a.selectedAreaId,areaNames:a.areaNames,barChartloading:d.models.areas||d.effects["dashboard/fetchRideCount"]||d.effects["dashboard/fetchCustomerCount"],activeRideCountLoading:d.models.areas||d.effects["dashboard/fetchDailyRideCounts"],weeklyBatteryStateLoading:d.models.areas||d.effects["dashboard/fetchWeeklyBatteryState"],revenueLoading:d.models.areas||d.effects["dashboard/fetchStripeDailyRevenue"],currentActiveRideLoading:d.models.areas||d.effects["dashboard/fetchDailyRideCounts"],weeklyBatterySwapLoading:d.models.areas||d.effects["dashboard/fetchDailyRideCounts"],dailyRideRevenueLoading:d.models.areas||d.effects["dashboard/fetchDailyRideRevenue"]}}),v(R=function(e){function a(e){var t;return(0,c.default)(this,a),t=(0,m.default)(this,(0,p.default)(a).call(this,e)),t.state={rangePickerValue:(0,D.getTimeDistance)("month"),offset:(new Date).getTimezoneOffset()/-60+1,countParams:{period:"month"}},t.setClickedMarker=function(e){t.setState({selectedMarker:e})},t.selectDate=function(e){t.props.dispatch;t.setState({countParams:(0,u.default)({},t.state.rideCountParams,{period:e}),rangePickerValue:(0,D.getTimeDistance)(e)},t.loadBarCharData)},t.handleRangePickerChange=function(e){t.props.dispatch;t.setState({rangePickerValue:e},t.loadBarCharData)},t.getRankingBoard=function(){var e=t.props,a=e.dashboard,d=e.areaNames;return A.includes("get.ride.vehicle.rank")&&E.default.createElement(o.default,{xl:8,lg:12,md:12,sm:24,xs:24},E.default.createElement("div",{className:T.default.salesRank},E.default.createElement("h4",{className:T.default.rankingTitle},E.default.createElement(C.FormattedMessage,{id:"app.dashboard.rides-ranking",defaultMessage:"Rides Ranking"})),E.default.createElement("ul",{className:T.default.rankingList,style:{height:200,marginBottom:"20px",overflow:"scroll"}},a.ridePerVehicleRank.map(function(e,a){return E.default.createElement("li",{key:e.areaId},E.default.createElement("span",{className:"".concat(T.default.rankingItemNumber," ").concat(a<3?T.default.active:"")},a+1),E.default.createElement("span",{className:T.default.rankingItemTitle,title:d[e.areaId]},d[e.areaId]),E.default.createElement("span",{className:T.default.rankingItemValue},(0,x.default)(e.avgRides).format("0,0.00")))}))))},t}return(0,h.default)(a,e),(0,f.default)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.selectedAreaId,this.props.dispatch;this.reqRef=requestAnimationFrame(function(){e.loadBarCharData(),e.loadDailyRideCount(),e.loadWeeklyBatteryStatus(),e.loadStripeRevenue(),e.loadDailyRideRevenue(),e.timeoutId=setTimeout(function(){e.setState({loading:!1})},600),e.pollingId=setInterval(function(){e.loadDailyRideCount(),e.loadWeeklyBatteryStatus(),e.loadDailyRideRevenue(),e.setState({areaIsChanged:!1})},1e4)})}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e({type:"dashboard/clear"}),cancelAnimationFrame(this.reqRef),clearTimeout(this.timeoutId),clearInterval(this.pollingId)}},{key:"loadBarCharData",value:function(){this.fetchRideCount(),this.fetchCustomerCount(),this.getStripeRevenueByPeriod(),this.fetchRidePerVehicleRank(),this.getConnectivityByPeriod()}},{key:"loadDailyRideCount",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId;A.includes("get.daily.ride.count")&&a({type:"dashboard/fetchDailyRideCounts",params:{areaId:t,midnight:(0,N.default)().startOf("day").unix()}})}},{key:"loadRideDailyRevenue",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId;A.includes("get.daily.ride.revenue")&&a({type:"dashboard/fetchDailyRideRevenue",params:{areaId:t,midnight:(0,N.default)().startOf("day").unix()}})}},{key:"loadStripeRevenue",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId;A.includes("get.stripe.revenue")&&a({type:"dashboard/fetchStripeDailyRevenue",params:{areaId:t,midnight:(0,N.default)().startOf("day").unix()}})}},{key:"loadDailyRideRevenue",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId;A.includes("get.daily.ride.revenue")&&a({type:"dashboard/fetchDailyRideRevenue",params:{areaId:t,midnight:(0,N.default)().startOf("day").unix()}})}},{key:"loadWeeklyBatteryStatus",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId,d=this.state.offset;A.includes("get.weekly.battery.state")&&a({type:"dashboard/fetchWeeklyBatteryState",params:{areaId:t,midnight:(0,N.default)().subtract(7,"d").unix(),offset:d}})}},{key:"getRangeEnd",value:function(e){var a=(0,N.default)();return e.diff(a,"seconds")>0?a:e}},{key:"fetchRideCount",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId,d=this.state,l=d.countParams,r=d.offset,n=d.rangePickerValue;A.includes("get.ride.count")&&a({type:"dashboard/fetchRideCount",params:Object.assign({},l,{offset:r,areaId:t,start:n[0].unix(),end:n[1].unix()})})}},{key:"fetchCustomerCount",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId,d=this.state,l=d.countParams,r=d.offset,n=d.rangePickerValue;A.includes("get.customer.count")&&a({type:"dashboard/fetchCustomerCount",params:Object.assign({},l,{offset:r,areaId:t,start:n[0].unix(),end:n[1].unix()})})}},{key:"getStripeRevenueByPeriod",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId,d=this.state,l=d.countParams,r=d.offset,n=d.rangePickerValue;A.includes("get.stripe.revenue.by.period")&&a({type:"dashboard/fetchStripRevenueByPeriod",params:Object.assign({},l,{offset:r,areaId:t||-1,start:n[0].unix(),end:n[1].unix()})})}},{key:"getConnectivityByPeriod",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId,d=this.state,l=d.countParams,r=d.offset,n=d.rangePickerValue;A.includes("get.connectivity.by.period")&&a({type:"dashboard/fetchConnectivityByPeriod",params:Object.assign({},l,{offset:r,areaId:t||-1,start:n[0].unix(),end:n[1].unix()})})}},{key:"fetchRidePerVehicleRank",value:function(){var e=this.props,a=e.dispatch,t=(e.selectedAreaId,this.state),d=t.rangePickerValue,l=t.offset;A.includes("get.ride.vehicle.rank")&&a({type:"dashboard/getRidePerVehicleRank",params:Object.assign({},{start:d[0].unix(),end:d[1].unix(),offset:l})})}},{key:"componentDidUpdate",value:function(e,a,t){e.selectedAreaId!==this.props.selectedAreaId&&(this.loadBarCharData(),this.loadDailyRideCount(),this.loadStripeRevenue(),this.setState({areaIsChanged:!0}))}},{key:"isActive",value:function(e){var a=this.state.rangePickerValue,t=(0,D.getTimeDistance)(e);return a[0]&&a[1]&&a[0].isSame(t[0],"day")&&a[1].isSame(t[1],"day")?T.default.currentDate:""}},{key:"render",value:function(){var e=this,a=this.props,t=(a.selectedAreaId,a.geo,a.areaNames,a.barChartloading),d=(a.activeRideCountLoading,a.dashboard),l=a.revenueLoading,u=(a.currentActiveRideLoading,a.weeklyBatterySwapLoading,a.dailyRideRevenueLoading,this.state),c=u.rangePickerValue,f=u.areaIsChanged,m=E.default.createElement("div",{className:T.default.salesExtraWrap},E.default.createElement("div",{className:T.default.salesExtra},E.default.createElement("a",{className:this.isActive("day"),onClick:function(){return e.selectDate("day")}},E.default.createElement(C.FormattedMessage,{id:"app.analysis.all-day",defaultMessage:"All Day"})),E.default.createElement("a",{className:this.isActive("week"),onClick:function(){return e.selectDate("week")}},E.default.createElement(C.FormattedMessage,{id:"app.analysis.all-week",defaultMessage:"All Week"})),E.default.createElement("a",{className:this.isActive("month"),onClick:function(){return e.selectDate("month")}},E.default.createElement(C.FormattedMessage,{id:"app.analysis.all-month",defaultMessage:"All Month"})),E.default.createElement("a",{className:this.isActive("year"),onClick:function(){return e.selectDate("year")}},E.default.createElement(C.FormattedMessage,{id:"app.analysis.all-year",defaultMessage:"All Year"}))),E.default.createElement(P,{value:c,onChange:this.handleRangePickerChange,style:{width:256}})),p=this.getRangeEnd(c[1]).diff(c[0],"days");0===p&&(p=1);var h=d.dailyRideCount,y=d.batteryState,v=d.stripeRevenue,R=d.dailyRideRevenue,b=y.weeklyBatterySwap&&y.weeklyBatterySwap.map(function(e){return{x:(0,N.default)().dayOfYear(e.dayOfYear).format("MM/DD"),y:e.total}});return E.default.createElement(B.default,null,E.default.createElement(n.default,{gutter:24,style:{marginTop:"2em"}},A.includes("get.daily.ride.count")&&E.default.createElement(o.default,S,E.default.createElement(M.ChartCard,{bordered:!1,title:"Current Active Rides",action:E.default.createElement(s.default,{title:"introduce"},E.default.createElement(i.default,{type:"info-circle-o"})),total:f?"loading":h.currentActiveRideCount,footer:E.default.createElement(M.Field,{label:"Total Ride Today",value:f?"loading":"".concat(h.todayRideCount)}),contentHeight:60},E.default.createElement(w.default,{flag:h.todayRideCount-h.lastWeekRideCount>0?"up":"down",style:{marginRight:16}},E.default.createElement(C.FormattedMessage,{id:"app.analysis.week",defaultMessage:"Weekly Changes"}),E.default.createElement("span",{className:T.default.trendText}," ",Math.round((h.todayRideCount-h.lastWeekRideCount)/h.lastWeekRideCount*100),"%")),E.default.createElement(w.default,{flag:h.todayRideCount-h.yesterdayRideCount>0?"up":"down"},E.default.createElement(C.FormattedMessage,{id:"app.analysis.day",defaultMessage:"Daily Changes"}),E.default.createElement("span",{className:T.default.trendText},Math.round((h.todayRideCount-h.yesterdayRideCount)/h.yesterdayRideCount*100),"%")))),A.includes("get.weekly.battery.state")&&b&&E.default.createElement(o.default,S,E.default.createElement(M.ChartCard,{bordered:!1,loading:!1,title:"Total Battery Swap Today",action:E.default.createElement(s.default,{title:E.default.createElement(C.FormattedMessage,{id:"app.analysis.introduce",defaultMessage:"introduce"})},E.default.createElement(i.default,{type:"info-circle-o"})),total:f?"loading":b[b.length-1]&&(0,x.default)(b[b.length-1].y).format("0,0"),footer:E.default.createElement(M.Field,{label:"Low Battery Vehicles",value:f?"loading":(0,x.default)(y.lowBatteryCount).format("0,0")}),contentHeight:60},E.default.createElement(M.MiniBar,{color:"#975FE4",data:b}))),A.includes("get.stripe.revenue")&&v&&E.default.createElement(o.default,S,E.default.createElement(M.ChartCard,{bordered:!1,title:"Today's Stripe Revenue",action:E.default.createElement(s.default,{title:"introduce"},E.default.createElement(i.default,{type:"info-circle-o"})),loading:!1,total:l?"loading":v.dailyRevenue/100,footer:E.default.createElement(M.Field,{label:"Total Revenue",value:l?"loading":"".concat(v.totalRevenue/100)}),contentHeight:60},E.default.createElement(w.default,{flag:v.dailyRevenue-v.lastWeekRevenue>0?"up":"down",style:{marginRight:16}},E.default.createElement(C.FormattedMessage,{id:"app.analysis.week",defaultMessage:"Weekly Changes"}),E.default.createElement("span",{className:T.default.trendText}," ",l?"loading":Math.round((v.dailyRevenue-v.lastWeekRevenue)/v.lastWeekRevenue*100),"%")),E.default.createElement(w.default,{flag:v.dailyRevenue-v.yesterdayRevenue>0?"up":"down"},E.default.createElement(C.FormattedMessage,{id:"app.analysis.day",defaultMessage:"Daily Changes"}),E.default.createElement("span",{className:T.default.trendText},l?"loading":Math.round((v.dailyRevenue-v.yesterdayRevenue)/v.yesterdayRevenue*100),"%")))),A.includes("get.daily.ride.revenue")&&R&&E.default.createElement(o.default,S,E.default.createElement(M.ChartCard,{bordered:!1,title:"Today's Ride Revenue",action:E.default.createElement(s.default,{title:"introduce"},E.default.createElement(i.default,{type:"info-circle-o"})),loading:!1,total:f?"loading":R.dailyRevenue,footer:E.default.createElement(M.Field,{label:"Total Revenue",value:"".concat(R.totalRevenue)}),contentHeight:60},E.default.createElement(w.default,{flag:R.dailyRevenue-R.lastWeekRevenue>0?"up":"down",style:{marginRight:16}},E.default.createElement(C.FormattedMessage,{id:"app.analysis.week",defaultMessage:"Weekly Changes"}),E.default.createElement("span",{className:T.default.trendText}," ",Math.round((R.dailyRevenue-R.lastWeekRevenue)/R.lastWeekRevenue*100),"%")),E.default.createElement(w.default,{flag:R.dailyRevenue-R.yesterdayRevenue>0?"up":"down"},E.default.createElement(C.FormattedMessage,{id:"app.analysis.day",defaultMessage:"Daily Changes"}),E.default.createElement("span",{className:T.default.trendText},Math.round((R.dailyRevenue-R.yesterdayRevenue)/R.yesterdayRevenue*100),"%"))))),(A.includes("get.ride.count")||A.includes("get.ride.count"))&&E.default.createElement(r.default,{loading:t,bordered:!1,bodyStyle:{padding:0}},E.default.createElement("div",{className:T.default.salesCard},E.default.createElement(g.default,{tabBarExtraContent:m,size:"large",tabBarStyle:{marginBottom:24}},A.includes("get.ride.count")&&E.default.createElement(W,{tab:E.default.createElement(C.FormattedMessage,{id:"app.analysis.sales",defaultMessage:"Sales"}),key:"rides"},E.default.createElement(n.default,null,E.default.createElement(o.default,{xl:16,lg:12,md:12,sm:24,xs:24},E.default.createElement("div",{className:T.default.salesBar},E.default.createElement(M.Bar,{height:295,title:E.default.createElement(C.FormattedMessage,{id:"app.dashboard.rides-trend",defaultMessage:"Rides Trend"}),data:d.rideCountData}))),this.getRankingBoard())),A.includes("get.ride.count")&&E.default.createElement(W,{tab:E.default.createElement(C.FormattedMessage,{id:"app.dashboard.customers",defaultMessage:"Customers"}),key:"customers"},E.default.createElement(n.default,null,E.default.createElement(o.default,{xl:16,lg:12,md:12,sm:24,xs:24},E.default.createElement("div",{className:T.default.salesBar},E.default.createElement(M.Bar,{height:292,title:E.default.createElement(C.FormattedMessage,{id:"app.dashboard.customers-trend",defaultMessage:"Customer Trend"}),data:d.customerCountData}))),this.getRankingBoard())),A.includes("get.stripe.revenue.by.period")&&E.default.createElement(W,{tab:"Stripe Revenue",key:"revenue"},E.default.createElement(n.default,null,E.default.createElement(o.default,{xl:16,lg:12,md:12,sm:24,xs:24},E.default.createElement("div",{className:T.default.salesBar},E.default.createElement(M.Bar,{height:292,title:"Revenue Trend",data:d.stripeRevenueData}))),this.getRankingBoard())),A.includes("get.connectivity.by.period")&&E.default.createElement(W,{tab:"Vehicle Connectivity",key:"connectivity"},E.default.createElement(n.default,null,E.default.createElement(o.default,{xl:16,lg:12,md:12,sm:24,xs:24},E.default.createElement("div",{className:T.default.salesBar},E.default.createElement(M.Bar,{height:292,title:"Connectivity Trend",data:d.connectivity}))),this.getRankingBoard()))))))}}]),a}(E.Component))||R),L=F;a.default=L},YR7N:function(e,a,t){"use strict";var d=t("TqRt");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=d(t("pVnL"));t("Pwec");var r=d(t("CtXQ")),n=d(t("lSNA")),s=d(t("QILm")),i=d(t("q1tI")),o=d(t("TSYQ")),u=d(t("7Zm1")),c=function(e){var a,t=e.colorful,d=void 0===t||t,c=e.reverseColor,f=void 0!==c&&c,m=e.flag,p=e.children,h=e.className,g=(0,s.default)(e,["colorful","reverseColor","flag","children","className"]),y=(0,o.default)(u.default.trendItem,(a={},(0,n.default)(a,u.default.trendItemGrey,!d),(0,n.default)(a,u.default.reverseColor,f&&d),a),h);return i.default.createElement("div",(0,l.default)({},g,{className:y,title:"string"===typeof p?p:""}),i.default.createElement("span",{className:u.default.value},p),m&&i.default.createElement("span",{className:u.default[m]},i.default.createElement(r.default,{type:"caret-".concat(m)})))},f=c;a.default=f},rBGm:function(e,a,t){e.exports={fenceColorIndex:"antd-pro-pages-dashboard-dashboard-fenceColorIndex",editRow:"antd-pro-pages-dashboard-dashboard-editRow",editButton:"antd-pro-pages-dashboard-dashboard-editButton",bikeIcon:"antd-pro-pages-dashboard-dashboard-bikeIcon",iconGroup:"antd-pro-pages-dashboard-dashboard-iconGroup",rankingList:"antd-pro-pages-dashboard-dashboard-rankingList",rankingItemNumber:"antd-pro-pages-dashboard-dashboard-rankingItemNumber",active:"antd-pro-pages-dashboard-dashboard-active",rankingItemTitle:"antd-pro-pages-dashboard-dashboard-rankingItemTitle",salesExtra:"antd-pro-pages-dashboard-dashboard-salesExtra",currentDate:"antd-pro-pages-dashboard-dashboard-currentDate",salesCard:"antd-pro-pages-dashboard-dashboard-salesCard",salesBar:"antd-pro-pages-dashboard-dashboard-salesBar",salesRank:"antd-pro-pages-dashboard-dashboard-salesRank",salesCardExtra:"antd-pro-pages-dashboard-dashboard-salesCardExtra",salesTypeRadio:"antd-pro-pages-dashboard-dashboard-salesTypeRadio",offlineCard:"antd-pro-pages-dashboard-dashboard-offlineCard",trendText:"antd-pro-pages-dashboard-dashboard-trendText",rankingTitle:"antd-pro-pages-dashboard-dashboard-rankingTitle",salesExtraWrap:"antd-pro-pages-dashboard-dashboard-salesExtraWrap"}}}]);