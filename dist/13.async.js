(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{yfUg:function(e,a,t){"use strict";var r=t("TqRt"),n=t("284h");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("IzEo");var o=r(t("bx4M"));t("jCWc");var l=r(t("kPKH"));t("14J3");var c=r(t("BMrR")),i=r(t("lSNA")),d=r(t("lwsE")),s=r(t("W8MJ")),f=r(t("a1gu")),u=r(t("Nsbk")),m=r(t("7W2i"));t("iQDF");var p,g,h=r(t("+eQT")),y=n(t("q1tI")),k=t("MuoO"),E=(t("LLXN"),t("34ay")),v=(r(t("ZhIB")),r(t("4IMT")),r(t("QLqA")),r(t("yt27"))),S=t("4XXU"),D=r(t("v99g")),b=t("+n12"),I=(0,E.getAuthority)(),C=h.default.RangePicker,A=1e3,B={longRidesScore:{name:"Long Ride Score",intro:"",color:"#ff0400"},pendingReportScore:{name:"Pending Report Score",intro:"",color:"#e68e5c"},onlineVehicleScore:{name:"Online Vehicle Score",intro:"",color:"#16fac5"},lowBatteryVehicleScore:{name:"Low Battery Score",intro:"",color:"#82ca9d"},idleVehicleScore:{name:"Idle Vehicle Score",intro:"",color:"#ffa930"},primeLocationScore:{name:"Prime Location Score",intro:"",color:"#30ff3a"},badLocationScore:{name:"Bad Location Score",intro:"",color:"#30d6db"},operationMarginScore:{name:"Opertation Margin Score",intro:"",color:"#c3c912"},finalScore:{name:"Final Score",intro:"",color:"#3055db"}},R=(p=(0,k.connect)(function(e){var a=e.areas,t=e.performance,r=(e.geo,e.loading);e.chart;return{performance:t,selectedAreaId:a.selectedAreaId,areaNames:a.areaNames,historyDataLoading:r.models.areas||r.effects["performance/historyData"],rankingDataLoading:r.models.areas||r.effects["performance/rankingData"]}}),p(g=function(e){function a(){var e,t;(0,d.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t=(0,f.default)(this,(e=(0,u.default)(a)).call.apply(e,[this].concat(n))),t.state={rangePickerValue:(0,b.getTimeDistance)("month"),offset:0,countParams:{filter:"day"}},t.handleRangePickerChange=function(e){t.props.dispatch;t.setState({rangePickerValue:e},t.loadData)},t.getFilterContent=function(){var e=t.state,a=e.rangePickerValue;e.areaIsChanged;return y.default.createElement("div",{className:v.default.filterExtraWrap},y.default.createElement(C,{value:a,onChange:t.handleRangePickerChange,style:{width:256}}),y.default.createElement("div",{className:v.default.filterExtra},y.default.createElement("a",{className:t.isActive("week"),onClick:function(){return t.selectDate("week")}},"Week"),y.default.createElement("a",{className:t.isActive("month"),onClick:function(){return t.selectDate("month")}},"Month"),y.default.createElement("a",{className:t.isActive("year"),onClick:function(){return t.selectDate("year")}},"Year")))},t.selectDate=function(e){t.props.dispatch;t.setState({rangePickerValue:(0,b.getTimeDistance)(e)},t.loadData)},t}return(0,m.default)(a,e),(0,s.default)(a,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(e,a,t){e.selectedAreaId!==this.props.selectedAreaId&&this.loadHistoryData()}},{key:"loadData",value:function(){this.loadHistoryData(),this.loadRankingData()}},{key:"loadRankingData",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId,r=this.state,n=r.countParams,o=r.offset,l=r.rangePickerValue;I.includes("get.area.performance.rank")&&a({type:"performance/getRankingData",params:Object.assign({},n,{offset:o,areaId:t>0?t:null,startDate:l[0].toISOString(),endDate:l[1].toISOString(),pageSize:A})})}},{key:"loadHistoryData",value:function(){var e,a=this.props,t=a.dispatch,r=a.selectedAreaId,n=this.state,o=n.countParams,l=n.offset,c=n.rangePickerValue;I.includes("get.area.performance.history")&&t({type:"performance/getHistoryData",params:Object.assign({},o,(e={offset:l,areaIds:r>0?[r]:[],startDate:c[0].toISOString(),endDate:c[1].toISOString()},(0,i.default)(e,"offset",0),(0,i.default)(e,"limit",1e3),e))})}},{key:"isActive",value:function(e){var a=this.state.rangePickerValue,t=(0,b.getTimeDistance)(e);return a[0]&&a[1]&&a[0].isSame(t[0],"day")&&a[1].isSame(t[1],"day")?v.default.currentDate:""}},{key:"render",value:function(){var e=this.props,a=e.performanceHistoryDataLoading,t=e.performance,r=e.areaNames,n=e.selectedAreaId,i=this.state;i.rangePickerValue,i.areaIsChanged;return y.default.createElement(D.default,null,y.default.createElement(c.default,{gutter:24,style:{marginTop:"2em"}},y.default.createElement(o.default,{loading:a,bordered:!1,bodyStyle:{padding:"2em"}},y.default.createElement(c.default,{style:{paddingBottom:"0.5em",borderBottom:"1px solid #e8e8e8"}},this.getFilterContent()),y.default.createElement(c.default,{style:{marginTop:"0.5em"}},I.includes("get.area.performance.rank")&&y.default.createElement(l.default,{xl:14,lg:12,md:12,sm:24,xs:24},y.default.createElement("div",{className:v.default.scoreBar},y.default.createElement(c.default,null,y.default.createElement(l.default,{span:12},y.default.createElement("p",{style:{marginBottom:20,marginLeft:"2em",font:"1.2em bold",color:"black"}},"".concat(n>0?r[n]:"All Area"," Performance By Date"),"  "))),y.default.createElement(S.ResponsiveContainer,{width:"95%",height:400},y.default.createElement(S.ComposedChart,{data:t.historyData,margin:{top:20,right:30,left:0,bottom:5},stackOffset:"sign"},y.default.createElement(S.CartesianGrid,{strokeDasharray:"3 3"}),y.default.createElement(S.XAxis,{dataKey:"period"}),y.default.createElement(S.YAxis,null),y.default.createElement(S.Tooltip,{formatter:function(e,a,t){return["".concat(Math.round(100*e)/100,"%"),B[a].name]}}),y.default.createElement(S.ReferenceLine,{y:-100,stroke:"#000"}),Object.keys(B).map(function(e){if("finalScore"!==e){var a=B[e];return y.default.createElement(S.Bar,{dataKey:e,key:e,stackId:"a",fill:a.color})}}),y.default.createElement(S.Line,{type:"monotone",dataKey:"finalScore",stroke:B.finalScore.color}))))),I.includes("get.area.performance.rank")&&y.default.createElement(l.default,{xl:10,lg:12,md:12,sm:24,xs:24},y.default.createElement("div",{className:v.default.scoreBar},y.default.createElement("h4",{style:{marginBottom:20}}," Ranking "),y.default.createElement("div",{style:{height:400,overflowY:"scroll"}},y.default.createElement(S.ResponsiveContainer,{width:"95%",height:1800},y.default.createElement(S.BarChart,{data:t.rankingData.map(function(e,a){return Object.assign(e,{areaName:"".concat(a+1,". ").concat(r[e.areaId])})}),margin:{top:20,right:30,left:40,bottom:5},stackOffset:"sign",layout:"vertical"},y.default.createElement(S.XAxis,{type:"number",hide:!0}),y.default.createElement(S.YAxis,{type:"category",dataKey:"areaName",tick:{fontWeight:"bold",fontSize:"0.8em"}}),y.default.createElement(S.Tooltip,{formatter:function(e,a,t){return[Math.round(100*e)/100,B[a].name]}}),y.default.createElement(S.ReferenceLine,{y:-100,stroke:"#000"}),Object.keys(B).map(function(e){if("finalScore"!==e){var a=B[e];return y.default.createElement(S.Bar,{dataKey:e,key:e,stackId:"a",fill:a.color})}}))))))),y.default.createElement(c.default,{style:{paddingBottom:"1em"}},y.default.createElement(S.ResponsiveContainer,{width:"95%",height:100},y.default.createElement(S.BarChart,{data:t.rankingData.map(function(e,a){return Object.assign(e,{areaName:"".concat(a+1,". ").concat(r[e.areaId])})})},y.default.createElement(S.XAxis,{type:"number",hide:!0}),y.default.createElement(S.YAxis,{type:"category",dataKey:"areaName",tick:{fontWeight:"bold"},hide:!0}),y.default.createElement(S.Legend,{formatter:function(e,a,t){return y.default.createElement("span",null," ",B[e].name," ")}}),Object.keys(B).map(function(e){if("finalScore"!==e){var a=B[e];return y.default.createElement(S.Bar,{dataKey:e,key:e,stackId:"a",fill:a.color})}})))))))}}]),a}(y.Component))||g),L=R;a.default=L},yt27:function(e,a,t){e.exports={scoreCard:"antd-pro-pages-dashboard-performance-scoreCard",scoreBar:"antd-pro-pages-dashboard-performance-scoreBar",filterRank:"antd-pro-pages-dashboard-performance-filterRank",currentDate:"antd-pro-pages-dashboard-performance-currentDate",rankingTitle:"antd-pro-pages-dashboard-performance-rankingTitle",filterCard:"antd-pro-pages-dashboard-performance-filterCard",rankingList:"antd-pro-pages-dashboard-performance-rankingList",filterExtra:"antd-pro-pages-dashboard-performance-filterExtra"}}}]);