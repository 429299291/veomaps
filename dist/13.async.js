(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"67cV":function(e,t,a){"use strict";var l=a("284h"),r=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("DjyN");var n=r(a("NUBc"));a("IzEo");var i=r(a("bx4M")),d=r(a("lwsE")),c=r(a("W8MJ")),u=r(a("a1gu")),o=r(a("Nsbk")),s=r(a("7W2i")),f=l(a("q1tI")),m=(r(a("s+Rv")),r(a("MLAF"))),p=function(e){function t(e){var a;(0,d.default)(this,t),a=(0,u.default)(this,(0,o.default)(t).call(this,e));e.vehicles;return a.state={expandItem:null},a}return(0,s.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.state,t=(e.selectedRowKeys,e.needTotalList,this.props),a=t.vehicles,l=t.getResponsiveVehicleInfo,r=t.selectedVehicleId,d=t.totalCount,c=t.onPageChange;t.selectedVehicleRefresh;return f.default.createElement("div",null,a.map(function(e){return f.default.createElement(i.default,{key:e.id,className:m.default.card},l(e,r))}),f.default.createElement(n.default,{style:{marginTop:"1em"},defaultCurrent:1,total:d,onChange:c}))}}]),t}(f.PureComponent),h=p;t.default=h},MLAF:function(e,t,a){e.exports={card:"antd-pro-pages-vehicle-responsive-list-card"}},"m1+7":function(e,t,a){e.exports={tableList:"antd-pro-pages-vehicle-vehicle-tableList",tableListOperator:"antd-pro-pages-vehicle-vehicle-tableListOperator",heatMapFilterMobile:"antd-pro-pages-vehicle-vehicle-heatMapFilterMobile",heatMapFilter:"antd-pro-pages-vehicle-vehicle-heatMapFilter",tableListForm:"antd-pro-pages-vehicle-vehicle-tableListForm",submitButtons:"antd-pro-pages-vehicle-vehicle-submitButtons"}},nAvq:function(e,t,a){"use strict";var l=a("TqRt"),r=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a("pVnL"));a("IzEo");var i=l(a("bx4M"));a("giR+");var d=l(a("fyUT"));a("miYZ");var c=l(a("tsqr"));a("14J3");var u=l(a("BMrR"));a("Pwec");var o=l(a("CtXQ"));a("jCWc");var s=l(a("kPKH")),f=l(a("MVZn"));a("/zsF");var m=l(a("PArb")),p=l(a("lwsE")),h=l(a("W8MJ")),v=l(a("a1gu")),E=l(a("Nsbk")),y=l(a("7W2i"));a("2qtc");var g=l(a("kLXV"));a("T2oS");var b=l(a("W9HT"));a("+L6B");var M=l(a("2/Rp")),S=l(a("lSNA"));a("BoS7");var k=l(a("Sdc0"));a("7Kak");var w=l(a("9yH6"));a("OaEy");var C=l(a("2fM7"));a("5NDa");var V=l(a("5rEg"));a("FJo9");var I=l(a("L41K"));a("y8nQ");var T=l(a("Vl3Y"));a("Znn+");var A=l(a("ZTPi"));a("iQDF");var P,D,F,L=l(a("+eQT")),R=r(a("q1tI")),H=a("MuoO"),Y=l(a("wd/R")),x=l(a("CkN6")),N=l(a("zHco")),U=l(a("m1+7")),B=l(a("MQ4l")),O=a("0bUC"),z=(l(a("j+jj")),l(a("itZA"))),G=a("34ay"),q=a("+n12"),j=l(a("fqRC")),W=l(a("67cV")),_=L.default.RangePicker,K=A.default.TabPane,J=(0,G.getAuthority)(),Q=T.default.Item,Z=(I.default.Step,V.default.TextArea,C.default.Option),X=(w.default.Group,["Unlock","lock"]),$=["Bicycle","Scooter","E-Bike","Car"],ee={0:"Normal",1:"Error",3:"Deactivated",5:"Rebalance",6:"Maintain",7:"Out of Service"},te=Object.keys(ee),ae=function(e){var t=(0,Y.default)(e).format("YYYY-MM-DD HH:mm:ss");return t},le={vehicleId:"vehicleId",vehicleNumber:"vehicleNumber",vehicleType:"vehicleType",lockStatus:"lockStatus",reported:"reported",areaId:"areaId",imei:"imei",errorStatus:"errorStatus",connectStatus:"connectStatus",power:"power",vehiclePower:"vehiclePower",isTurnedOn:"isTurnedOn",heartTime:"heartTime",wirelessTech:"wirelessTech",mac:"mac",iccid:"iccid",firmware:"firmware",lat:"lat",lng:"lng"},re=["Mon","Tue","Weds","Thu","Fri","Sat","Sun"],ne=["12AM","1AM","2AM","3AM","4AM","5AM","6AM","7AM","8AM","9AM","10AM","11AM","12PM","1PM","2PM","3PM","4PM","5PM","6PM","7PM","8PM","9PM","10PM","11PM"],ie=function(e){return e>=420?100:e<420&&e>=411?95+5*(e-411)/9:e<411&&e>=395?90+5*(e-395)/16:e<395&&e>=386?80+10*(e-386)/9:e<386&&e>=379?70+10*(e-379)/7:e<379&&e>=373?60+10*(e-373)/6:e<373&&e>=369?50+10*(e-369)/4:e<369&&e>=365?40+10*(e-365)/4:e<365&&e>=363?30+10*(e-363)/2:e<363&&e>=359?20+10*(e-359)/4:e<359&&e>=354?10+10*(e-354)/5:e<354&&e>340?10*(e-340)/14:0},de=T.default.create()(function(e){var t=e.form,a=e.getAreaStartPoints,l=e.isMobile,r=e.styles,n=(e.selectedAreaId,e.shouldShowHeatMap),i=e.clearHeatMap,d=function(){t.validateFields(function(e,t){if(!e){null!==t.endhour&&null!==t.startHour||(null!==t.endhour&&(t.startHour=0),null!==t.startHour&&(t.endHour=23));var l=(new Date).getTimezoneOffset()/60;t.timeRange&&(t.start=(0,Y.default)(t.timeRange[0]).utcOffset(0).format("MM-DD-YYYY HH:mm:ss"),t.end=(0,Y.default)(t.timeRange[1]).utcOffset(0).format("MM-DD-YYYY HH:mm:ss"),t.timeRange=void 0),t.offset=l,void 0!==t.startHour&&(t.startHour=(t.startHour+l)%24),void 0!==t.endHour&&(t.endHour=(t.endHour+l)%24),a(t)}})},c=function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},u=l?"80%":"7%",o=l?"80%":"30%",s=l?"3vw":"1vw",f=l?r.heatMapFilterMobile:r.heatMapFilter;return R.default.createElement("div",{style:{fontSize:s,marginTop:"1em"}},R.default.createElement("span",{className:f},t.getFieldDecorator("isStart",{initialValue:!0})(R.default.createElement(k.default,{checkedChildren:"start",unCheckedChildren:"end",defaultChecked:!0})),R.default.createElement("span",null," Time: "),t.getFieldDecorator("timeRange")(R.default.createElement(_,(0,S.default)({style:{width:"20%"},format:"YYYY-MM-DD HH:mm:ss",showTime:!0},"style",{width:o})))),l&&R.default.createElement("br",null),R.default.createElement("span",{className:f},R.default.createElement("span",null," Weekday : "),t.getFieldDecorator("weekday")(R.default.createElement(C.default,{placeholder:"select",style:{width:u},showSearch:!0,filterOption:c},re.map(function(e,t){return R.default.createElement(Z,{value:t,key:t},e)})))),l&&R.default.createElement("br",null),R.default.createElement("span",{className:f},R.default.createElement("span",null," Hours : "),t.getFieldDecorator("startHour")(R.default.createElement(C.default,{placeholder:"select",style:{width:u},showSearch:!0,filterOption:c},ne.map(function(e,t){return R.default.createElement(Z,{value:t,key:t},e)}))),"~",t.getFieldDecorator("endHour")(R.default.createElement(C.default,{placeholder:"select",style:{width:u},showSearch:!0,filterOption:c},ne.map(function(e,t){return R.default.createElement(Z,{value:t,key:t},e)})))),R.default.createElement("span",{className:f},R.default.createElement("span",null," Type : "),t.getFieldDecorator("vehicleType")(R.default.createElement(C.default,{placeholder:"select",style:{width:u},filterOption:c},R.default.createElement(Z,{value:0},"Bike"),R.default.createElement(Z,{value:1},"Scooter"),R.default.createElement(Z,{value:2},"E-Bike")))),l&&R.default.createElement("br",null),R.default.createElement("div",{style:{float:"right",marginTop:"1em"}},R.default.createElement(M.default,{style:{marginRight:"1vw"},htmlType:"submit",onClick:function(){t.resetFields(),i()}}," Reset "),n?R.default.createElement(M.default,{type:"primary",htmlType:"submit",onClick:d}," Get HeatMap "):R.default.createElement(b.default,{size:"middle",style:{marginRight:"0.5vw"}})))}),ce=T.default.create()(function(e){var t=e.modalVisible,a=e.form,l=e.handleAdd,r=e.handleModalVisible,n=e.areas,i=function(){a.validateFields(function(e,t){e||(a.resetFields(),t.vehicleNumber=parseInt(t.vehicleNumber,10),l(t))})};return R.default.createElement(g.default,{destroyOnClose:!0,title:"Add",visible:t,onOk:i,onCancel:function(){return r()},width:"700px"},R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"ID"},a.getFieldDecorator("vehicleNumber",{rules:[{required:!0,message:"At least 8 Digits!",min:1}]})(R.default.createElement(V.default,{placeholder:"Please Input"}))),R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"IMEI"},a.getFieldDecorator("imei",{rules:[{required:!0,message:"At least 15 Digits!",min:1}]})(R.default.createElement(V.default,{placeholder:"Please Input"}))),R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Mac Address"},a.getFieldDecorator("mac",{rules:[{required:!0,message:"At least 8 Digits!",min:1}]})(R.default.createElement(V.default,{placeholder:"Please Input"}))),R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Type"},a.getFieldDecorator("vehicleType",{rules:[{required:!0,message:"You have pick a type"}]})(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"Bike"),R.default.createElement(Z,{value:"1"},"Scooter"),R.default.createElement(Z,{value:"2"},"E-Bike")))),n&&R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Area"},a.getFieldDecorator("areaId",{rules:[{required:!0,message:"You have pick a area"}]})(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},n.map(function(e){return R.default.createElement(Z,{key:e.id,value:e.id},e.name)})))))}),ue=T.default.create()(function(e){var t=e.form,a=e.modalVisible,l=e.handleUpdate,r=e.handleModalVisible,n=e.areas,i=e.record,d=function(){t.isFieldsTouched()?t.validateFields(function(e,a){e||(t.resetFields(),a.vehicleNumber=parseInt(a.vehicleNumber,10),Object.keys(a).map(function(e){i[e]===a[e]&&"areaId"!==e&&(a[e]=null)}),l(i.id,a,i))}):r()};return R.default.createElement(g.default,{destroyOnClose:!0,title:"Update",visible:a,onOk:d,onCancel:function(){return r()}},R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"ID"},t.getFieldDecorator("vehicleNumber",{rules:[{required:!0,message:"At least 8 Digits!",min:1}],initialValue:i.vehicleNumber+""})(R.default.createElement(V.default,{placeholder:"Please Input"}))),R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Lock Status"},t.getFieldDecorator("lockStatus",{initialValue:i.lockStatus})(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:0},"Unlock"),R.default.createElement(Z,{value:1},"Lock")))),R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Error Status"},t.getFieldDecorator("errorStatus",{initialValue:i.errorStatus+""})(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},te.map(function(e){return R.default.createElement(Z,{key:e,value:e,disabled:e>=5},ee[e])})))),R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Type"},t.getFieldDecorator("vehicleType",{rules:[{required:!0,message:"You have pick a type"}],initialValue:i.vehicleType})(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:0},"Bike"),R.default.createElement(Z,{value:1},"Scooter"),R.default.createElement(Z,{value:2},"E-Bike")))),n&&R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Area"},t.getFieldDecorator("areaId",{rules:[{required:!0,message:"You have pick a area"}],initialValue:i.areaId})(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},n.map(function(e){return R.default.createElement(Z,{key:e.id,value:e.id},e.name)})))))}),oe=(P=(0,H.connect)(function(e){var t=e.vehicles,a=e.areas,l=e.loading,r=e.geo,n=e.global;return{vehicles:t,areas:a.data,selectedAreaId:a.selectedAreaId,loading:l.models.vehicles,areaNames:a.areaNames,isMobile:n.isMobile,geo:r}}),D=T.default.create(),P(F=D(F=function(e){function t(){var e,a;(0,p.default)(this,t);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return a=(0,v.default)(this,(e=(0,E.default)(t)).call.apply(e,[this].concat(r))),a.state={modalVisible:!1,updateModalVisible:!1,detailModalVisible:!1,expandForm:!1,selectedRows:[],vehicleLocations:[],filterCriteria:{currentPage:1,pageSize:10},selectedRecord:{},selectedMarker:null,selectedTab:"1",shouldShowHeatMap:!0,shoudlShowVehicles:!0,heatMapMaxIntensity:0,heatMapRadius:15},a.columns=[{title:"ID",dataIndex:"vehicleNumber"},{title:"Power",dataIndex:"power",render:function(e){return R.default.createElement("p",null,(0,O.roundTo2Decimal)(ie(e))+"%")}},{title:"Status",dataIndex:"connectStatus",render:function(e,t){return R.default.createElement(R.Fragment,null,R.default.createElement("span",null,X[t.lockStatus]),R.default.createElement(m.default,{type:"vertical"}),R.default.createElement("span",null,ee[t.errorStatus]),R.default.createElement(m.default,{type:"vertical"}),R.default.createElement("span",null,a.isConnected(t)))}},{title:"HeartTime",dataIndex:"heartTime",sorter:!0,render:function(e){return R.default.createElement("span",null,ae(e))}},{title:"Ride Count",dataIndex:"rideCount",sorter:!0,render:function(e){return R.default.createElement("span",null,e)}},{title:"Last Ride Time",dataIndex:"lastRideTime",sorter:!0,render:function(e){return R.default.createElement("span",null,(0,Y.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{title:"Type",dataIndex:"vehicleType",render:function(e){return R.default.createElement("p",null,$[e])}},{title:"Vehicle Power",dataIndex:"vehiclePower",render:function(e){return R.default.createElement("p",null,"".concat(e,"%"))}},{title:"Chain Lock",dataIndex:"chainLockStatus",render:function(e){return R.default.createElement("p",null,"".concat(null!==e?X[e]:"null"))}},{title:"operation",render:function(e,t){return R.default.createElement(R.Fragment,null,R.default.createElement("a",{onClick:function(){return a.handleUpdateModalVisible(!0,t)}},"Update"),R.default.createElement(m.default,{type:"vertical"}),R.default.createElement("a",{onClick:function(){return a.handleDetailModalVisible(!0,t)}},"Detail"))}}],a.handleResponsiveItemClick=function(e){a.setState({selectedVehicleId:e===a.state.selectedVehicleId?null:e})},a.handleResponsivePageChange=function(e,t){var l=a.props.dispatch,r=a.state.filterCriteria,n=(0,f.default)({},r);n.currentPage=e,n.pageSize=t,a.setState({filterCriteria:n}),l({type:"vehicles/get",payload:n})},a.handleSetSelectedVehicleRefresh=function(e){a.setState({selectedVehicleRefresh:e})},a.changeLockStatus=function(e){var t=a.props,l=t.dispatch,r=t.isMobile;if(r)1===e.lockStatus?a.setState({unlockModalVisible:!0,readyToUnlockVehicle:e}):a.handleApplyingPickUpAction(0,e);else{var n=1===e.lockStatus?"vehicles/unlock":"vehicles/lock";("vehicles/unlock"===n&&J.includes("unlock.vehicle")||"vehicles/lock"===n&&J.includes("lock.vehicle"))&&l({type:n,id:e.id,onSuccess:function(){setTimeout(function(){a.handleSearch()},3e3)}})}},a.updateLocation=function(e){var t=a.props.dispatch;t({type:"vehicles/updateLocation",id:e,onSuccess:function(){setTimeout(function(){a.handleSetSelectedVehicleRefresh(!0)},4e3)}})},a.alertVehicle=function(e){var t=a.props.dispatch;t({type:"vehicles/alertVehicle",vehicleId:e})},a.clearHeatMap=function(){a.setState({areaStartPoints:void 0,shoudlShowVehicles:!0})},a.getResponsiveVehicleInfo=function(e,t){var l=a.state.selectedVehicleRefresh,r=(0,O.roundTo2Decimal)(ie(e.power)),n=0===e.vehicleType?r:e.vehiclePower,i=function(e){return e>60?"#04e508":e<40?"#e81309":"#EFAF13"},d=t===e.id;return R.default.createElement("div",{key:e.id,style:{textAlign:"center",fontSize:"3.5vw"}},R.default.createElement(u.default,null,R.default.createElement(s.default,{span:6},$[e.vehicleType]),d&&R.default.createElement(s.default,{offset:16,span:2},R.default.createElement(o.default,{type:"redo",onClick:function(){a.handleSearch(),a.handleSetSelectedVehicleRefresh(!0)}}))),d&&R.default.createElement(u.default,{style:{marginTop:"1em"}},R.default.createElement(B.default,{record:e,selectedVehicleRefresh:l,handleSetSelectedVehicleRefresh:a.handleSetSelectedVehicleRefresh})),d&&R.default.createElement(u.default,{style:{marginTop:"1em"}},R.default.createElement(s.default,{span:12}," Lock Power : ",R.default.createElement("span",{style:{color:i(r)}}," ",r," % "),"  "),R.default.createElement(s.default,{span:12}," Vehicle Power : ",R.default.createElement("span",{style:{color:i(e.vehiclePower)}},"  ",e.vehiclePower," % "),"  ")),d&&R.default.createElement(u.default,{style:{marginTop:"1em"}},R.default.createElement(s.default,{span:8},"Ride Count"),R.default.createElement(s.default,{span:8},"Heart Time"),R.default.createElement(s.default,{span:8},"Last Ride")),d&&R.default.createElement(u.default,null,R.default.createElement(s.default,{span:8},e.rideCount),R.default.createElement(s.default,{span:8},(0,Y.default)(e.heartTime).format("YYYY-MM-DD HH:mm:ss")),R.default.createElement(s.default,{span:8},(0,Y.default)(e.lastRideTime).format("YYYY-MM-DD HH:mm:ss"))),R.default.createElement(u.default,{style:{marginTop:"1em"}},R.default.createElement(s.default,{span:6}," ",e.vehicleNumber," "),R.default.createElement(s.default,{span:11},R.default.createElement("span",null,R.default.createElement(o.default,{type:1===e.lockStatus?"lock":"unlock",style:{color:1===e.lockStatus?"blue":"orange"}})," | "),R.default.createElement("span",{style:{color:0===e.errorStatus?"#04e508":"red"}},ee[e.errorStatus])," | ",R.default.createElement("span",{style:{color:1===e.connectStatus?"#04e508":"red"}},a.isConnected(e))),R.default.createElement(s.default,{span:7},"Battery: ",R.default.createElement("span",{style:{color:i(n)}}," ",n+"%"," ")," ")),d&&R.default.createElement(u.default,{style:{marginTop:"1em"}},R.default.createElement(s.default,{span:5},J.includes("unlock.vehicle")?R.default.createElement("a",{onClick:function(){return a.changeLockStatus(e)}},0===e.lockStatus&&1===e.vehicleType?"Lock":"Unlock"):R.default.createElement("span",{style:{color:"grey"}},0===e.lockStatus&&1===e.vehicleType?"Lock":"Unlock")),R.default.createElement(s.default,{span:5,style:{fontSize:"2.5vw"}},J.includes("update.vehicle.location")?R.default.createElement("a",{onClick:function(){return a.updateLocation(e.id)}},"Update Location"):R.default.createElement("span",{style:{color:"grey"}},"Update Location")),R.default.createElement(s.default,{span:5},J.includes("alert.vehicle")?R.default.createElement("a",{onClick:function(){return a.alertVehicle(e.id)}},"Beep"):R.default.createElement("span",{style:{color:"grey"}},"Beep")),R.default.createElement(s.default,{span:5},R.default.createElement("a",{onClick:function(){return a.handleUpdateModalVisible(!0,e)}},"Update")),R.default.createElement(s.default,{span:4},R.default.createElement("a",{onClick:function(){return a.handleDetailModalVisible(!0,e)}},"Detail"))),R.default.createElement(u.default,{style:{marginTop:"1em",marginBottom:"0px"},onClick:function(){return a.handleResponsiveItemClick(e.id)}},d?R.default.createElement(o.default,{type:"up"}):R.default.createElement(o.default,{type:"down"})))},a.handleGetListVehicles=function(){var e=a.props.dispatch,t=a.state.filterCriteria;e({type:"vehicles/getCount",payload:t}),e({type:"vehicles/get",payload:t})},a.handleStandardTableChange=function(e,t,l){var r=a.props.dispatch,n=a.state.filterCriteria,i=(0,f.default)({},n);i.currentPage=e.current,i.pageSize=e.pageSize,l.field&&(i.sorter="".concat(l.field,"_").concat(l.order)),a.setState({filterCriteria:i}),r({type:"vehicles/get",payload:i})},a.handleFormReset=function(){var e=a.props,t=e.form,l=(e.dispatch,a.state.filterCriteria);t.resetFields();var r={currentPage:1,pageSize:l.pageSize};a.setState({filterCriteria:r},function(){return a.handleSearch()})},a.toggleForm=function(){var e=a.state.expandForm;a.setState({expandForm:!e})},a.handleSearch=function(e){"object"===typeof e&&e.preventDefault();var t=a.props,l=(t.dispatch,t.form),r=t.selectedAreaId,n=a.state,i=n.filterCriteria,d=n.selectedTab;l.validateFields(function(e,t){if(!e){var l=Object.assign({},i,t,{currentPage:1,pageSize:10,areaId:r});t.vehiclePowerCustom&&(l.vehiclePower=t.vehiclePowerCustom),a.setState({filterCriteria:l},function(){switch(d){case"1":a.handleGetListVehicles();break;case"2":a.handleGetMapData();break;default:return}})}})},a.handleUpdateAllLocations=function(e){"object"===typeof e&&e.preventDefault();var t=a.props,l=t.dispatch,r=t.form,n=t.selectedAreaId,i=a.state,d=i.filterCriteria;i.selectedTab;r.validateFields(function(e,t){if(!e){var r=Object.assign({},d,t,{currentPage:1,pageSize:10,areaId:n});a.setState({filterCriteria:r},function(){return l({type:"vehicles/updateAllLocations",payload:d,areaId:n})})}})},a.handleModalVisible=function(e){a.setState({createModalVisible:!!e})},a.handleUpdateModalVisible=function(e,t){a.setState({updateModalVisible:!!e,selectedRecord:t||{}})},a.handleDetailModalVisible=function(e,t){a.setState({detailModalVisible:!!e,selectedRecord:t||{}})},a.handleDeleteModalVisible=function(e,t){a.setState({updateModalVisible:!!e,selectedRecord:t||{}})},a.handleAdd=function(e){var t=a.props.dispatch;t({type:"vehicles/add",payload:e}),a.handleModalVisible()},a.handleApplyingPickUpAction=function(e,t){var l=a.props,r=l.dispatch,n=l.isMobile;if(J.includes("apply.action"))if(n){var i={};switch(i.actionType=e>=5?0:1,e){case 5:i.reasonType=1;break;case 6:i.reasonType=2;break;case 7:i.reasonType=0;break;default:break}navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){i.location={lat:e.coords.latitude,lng:e.coords.longitude},r({type:"vehicles/applyAction",payload:i,id:t.id,vehicleNumber:t.vehicleNumber,onSuccess:a.handleGetListVehicles})}):error.message("You have to enable to gps location to apply action to vehicle.")}else c.default.error("can't apply action to vehicle on pc.");else c.default.error("You don't have permmision to apply action to this vehicle.")},a.handleUpdate=function(e,t){var l=a.props,r=l.dispatch;l.isMobile;r({type:"vehicles/update",payload:t,id:e,onSuccess:a.handleGetListVehicles}),a.handleUpdateModalVisible()},a.getAreaGeoInfo=function(){var e=a.props,t=e.dispatch,l=e.selectedAreaId;t({type:"geo/getFences",areaId:l}),t({type:"geo/getCenter",areaId:l})},a.setClickedMarker=function(e){a.setState({selectedMarker:e})},a.hadnleTabChange=function(e){a.setState({selectedTab:e},a.handleSearch)},a.getAreaStartPoints=function(e){var t,l=a.props,r=l.dispatch,n=l.selectedAreaId;a.setState({shouldShowHeatMap:!1}),r((t={type:"vehicles/getStartPoints",areaId:n,params:e},(0,S.default)(t,"params",e),(0,S.default)(t,"onSuccess",function(e){return a.setState({areaStartPoints:e,shouldShowHeatMap:!0,heatMapMaxIntensity:2*(Math.floor(e.length/1e3)+1)})}),t))},a.handleGetMapData=function(){var e=a.props.selectedAreaId;e>=1&&(a.getVehicleLocations(),a.getAreaGeoInfo())},a.formatCsvData=function(e){return e.map(function(e){return e.heartTime=(0,Y.default)(e.heartTime).format("YYYY-MM-DD HH:mm:ss"),e})},a.handleSetHeatMapMaxIntensity=function(e){a.setState({heatMapMaxIntensity:e})},a.handleSetHeatMapRadius=function(e){a.setState({heatMapRadius:e})},a.handleGetMyLocation=function(e){if(e.target.checked){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(e){return a.setState({currPosition:e})});var t=navigator.geolocation.watchPosition(function(e){return a.setState({currPosition:e})},function(e){return console.log(e)},{enableHighAccuracy:!0,timeout:1e4});a.setState({watchId:t})}}else navigator.geolocation&&navigator.geolocation.clearWatch(a.state.watchId),a.setState({currPosition:null,watchId:null})},a.handleShowingVehicles=function(e){a.setState({shoudlShowVehicles:e.target.checked})},a}return(0,y.default)(t,e),(0,h.default)(t,[{key:"componentDidMount",value:function(){if(this.handleSearch(),this.props.isMobile){var e=document.getElementById("numberOrImei");e&&(e.setAttribute("type","number"),e.setAttribute("pattern","[0-9]*"))}}},{key:"isConnected",value:function(e){return 1===e.connectStatus?"online":"offline"}},{key:"componentDidUpdate",value:function(e,t,a){e.selectedAreaId!==this.props.selectedAreaId&&this.handleSearch()}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return R.default.createElement(T.default,{onSubmit:this.handleSearch,layout:"inline"},R.default.createElement(u.default,{gutter:{md:8,lg:24,xl:48}},R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Keywords"},e("numberOrImei")(R.default.createElement(V.default,{placeholder:"number or imei"})))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Battery Status"},e("lockPower")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"Low Battery"),R.default.createElement(Z,{value:"1"},"Full Battery"),R.default.createElement(Z,{value:null},"All"))))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Connection Status"},e("connectStatus")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"offline"),R.default.createElement(Z,{value:"1"},"online"),R.default.createElement(Z,{value:null},"All")))))),R.default.createElement("div",{style:{overflow:"hidden"}},R.default.createElement("div",{style:{float:"right",marginBottom:24}},R.default.createElement(M.default,{type:"primary",htmlType:"submit"},"Search"),R.default.createElement(M.default,{style:{marginLeft:8},onClick:this.handleFormReset},"Reset"),R.default.createElement("a",{style:{marginLeft:8},onClick:this.toggleForm},"more ",R.default.createElement(o.default,{type:"down"})))))}},{key:"renderAdvancedForm",value:function(){var e=this.props.form.getFieldDecorator,t=(this.props.areas,function(e,t,a){console.log(t),void 0===t||t>0&&Number.isInteger(t)?a():a("Number must be larger than zero.")});return R.default.createElement(T.default,{onSubmit:this.handleSearch,layout:"inline"},R.default.createElement(u.default,{gutter:{md:8,lg:24,xl:48}},R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Keywords"},e("numberOrImei")(R.default.createElement(V.default,{className:"number_or_imei_input",placeholder:"number or imei"})))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Lock Battery Status"},e("lockPower")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"Low Battery"),R.default.createElement(Z,{value:"1"},"Full Battery"),R.default.createElement(Z,{value:null},"All"))))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Connection Status"},e("connectStatus")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"offline"),R.default.createElement(Z,{value:"1"},"online"),R.default.createElement(Z,{value:null},"All")))))),R.default.createElement(u.default,{gutter:{md:8,lg:24,xl:48}},R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Lock Status"},e("lockStatus")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"Unlock"),R.default.createElement(Z,{value:"1"},"Lock"),R.default.createElement(Z,{value:null},"All"))))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Vehicle Type"},e("vehicleType")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"Bike"),R.default.createElement(Z,{value:"1"},"Scooter"),R.default.createElement(Z,{value:"2"},"e-bike"),R.default.createElement(Z,{value:null},"All"))))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Error Status"},e("errorStatus",{initialValue:["0","1","5","6","7"]})(R.default.createElement(C.default,{mode:"multiple",placeholder:"select",style:{width:"100%"}},te.map(function(e){return console.log(e),R.default.createElement(Z,{value:e,key:e},ee[e])})))))),R.default.createElement(u.default,{gutter:{md:8,lg:24,xl:48}},R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Is Using"},e("isUsing")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:!0},"Yes"),R.default.createElement(Z,{value:!1},"No"),R.default.createElement(Z,{value:null},"All"))))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Vehicle Power Status"},e("vehiclePower")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:"0"},"Low Battery"),R.default.createElement(Z,{value:"1"},"Full Battery"),R.default.createElement(Z,{value:null},"All"))))),R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{labelCol:{span:5},wrapperCol:{span:15},label:"Idle Days"},e("idleDays",{rules:[{validator:t}]})(R.default.createElement(d.default,{placeholder:"Please Input"}))))),R.default.createElement(u.default,{gutter:{md:8,lg:24,xl:48}},R.default.createElement(s.default,{md:8,sm:24},R.default.createElement(Q,{label:"Is Reported"},e("isReported")(R.default.createElement(C.default,{placeholder:"select",style:{width:"100%"}},R.default.createElement(Z,{value:!0},"Yes"),R.default.createElement(Z,{value:!1},"No"),R.default.createElement(Z,{value:null},"All"))))),R.default.createElement(s.default,{md:12,sm:24},R.default.createElement(Q,{label:"Custom Vehicle Power Search:"},e("vehiclePowerCustom")(R.default.createElement(d.default,{placeholder:"power"}))," %"))),R.default.createElement("div",{style:{overflow:"hidden"}},R.default.createElement("div",{style:{float:"right",marginBottom:24}},R.default.createElement(M.default,{type:"primary",htmlType:"submit"},"Search"),R.default.createElement(M.default,{style:{marginLeft:8},onClick:this.handleFormReset},"Reset"),R.default.createElement("a",{style:{marginLeft:8},onClick:this.toggleForm},"close ",R.default.createElement(o.default,{type:"up"})))))}},{key:"renderForm",value:function(){var e=this.state.expandForm;return e?this.renderAdvancedForm():this.renderSimpleForm()}},{key:"getVehicleLocations",value:function(){var e=this,t=this.props,a=t.dispatch,l=(t.selectedAreaId,this.state.filterCriteria);a({type:"vehicles/getVehicleLocation",payload:l,onSuccess:function(t){return e.setState({vehicleLocations:t})}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.vehicles,l=t.areas,r=t.loading,d=t.selectedAreaId,c=t.geo,o=t.areaNames,s=c.area&&c.area.center,f=c.fences,m=this.state,p=m.createModalVisible,h=m.updateModalVisible,v=m.detailModalVisible,E=m.selectedRecord,y=m.filterCriteria,b=m.selectedMarker,S=m.selectedTab,k=m.vehicleLocations,w=m.areaStartPoints,C=m.shouldShowHeatMap,V=m.selectedVehicleId,I=m.selectedVehicleRefresh,T=m.heatMapMaxIntensity,P=m.heatMapRadius,D=m.currPosition,F=m.shoudlShowVehicles,L={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},H={handleModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate},Y={defaultCurrent:1,current:y.currentPage,pageSize:y.pageSize,total:a.total};return R.default.createElement(N.default,{title:"Vehicle List"},R.default.createElement(i.default,{bordered:!1},R.default.createElement("div",{className:U.default.tableList},R.default.createElement("div",{className:U.default.tableListForm},this.renderForm()),R.default.createElement("div",{className:U.default.tableListOperator},R.default.createElement(M.default,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"Add"),d>=1&&J.includes("update.all.vehicle.location")&&R.default.createElement(M.default,{type:"primary",onClick:function(){return e.handleUpdateAllLocations()}},"Update All Locations"),R.default.createElement("span",{style:{marginLeft:"1em"}},"count: ".concat("1"===S?a.total:k.length))),R.default.createElement(A.default,{defaultActiveKey:"1",onChange:this.hadnleTabChange},R.default.createElement(K,{tab:"List View",key:"1"},this.props.isMobile?R.default.createElement(W.default,{vehicles:a.data,selectedVehicleId:V,getResponsiveVehicleInfo:this.getResponsiveVehicleInfo,selectedVehicleRefresh:I,totalCount:a.total,onPageChange:this.handleResponsivePageChange}):R.default.createElement(x.default,{loading:r,data:{list:a.data,pagination:Y},columns:this.columns,onChange:this.handleStandardTableChange,scroll:{x:1300}})),d>=1&&R.default.createElement(K,{tab:"Map View",key:"2"},s&&f&&R.default.createElement(j.default,{center:s,vehicles:k,fences:f,heatMapData:w,shouldShowHeatMap:C,handleGetMapData:this.handleGetMapData,styles:U.default,heatMapMaxIntensity:T,heatMapRadius:P,handleSetHeatMapMaxIntensity:this.handleSetHeatMapMaxIntensity,handleSetHeatMapRadius:this.handleSetHeatMapRadius,currPosition:D,handleGetMyLocation:this.handleGetMyLocation,handleShowingVehicles:this.handleShowingVehicles,shoudlShowVehicles:F,vehicleTypeFilter:{unlock:!0,lock:!0,lowBattery:!0,error:!0,errorUnlock:!0,ebike:!0},setClickedMarker:this.setClickedMarker,selectedMarker:b}),J.includes("get.area.start.points")&&!this.props.isMobile&&R.default.createElement(de,{isMobile:this.props.isMobile,styles:U.default,getAreaStartPoints:this.getAreaStartPoints,shouldShowHeatMap:C,clearHeatMap:this.clearHeatMap,selectedAreaId:d}),k.length>0&&R.default.createElement(M.default,{style:{marginTop:"1em"},onClick:function(){return(0,q.exportCSVFile)(le,e.formatCsvData(k),o[d])}},"Export"))))),R.default.createElement(ce,(0,n.default)({},L,{modalVisible:p,areas:l})),R.default.createElement(ue,(0,n.default)({},H,{modalVisible:h,record:E,areas:l})),v&&R.default.createElement(z.default,{isVisible:v,handleDetailVisible:this.handleDetailModalVisible,vehicleId:E.id,handleGetVehicles:this.handleGetListVehicles}),R.default.createElement(g.default,{footer:null,visible:this.props.isMobile&&this.state.unlockModalVisible,destroyOnClose:!0,onCancel:function(){return e.setState({unlockModalVisible:!1})},title:"Purpose for Unlock"},[5,6,7].map(function(t){return R.default.createElement(u.default,{style:{textAlign:"center",marginTop:"2em"}},R.default.createElement(M.default,{style:{width:"80vw"},type:"primary",onClick:function(){return e.handleApplyingPickUpAction(t,e.state.readyToUnlockVehicle)}},ee[t]))})))}}]),t}(R.PureComponent))||F)||F),se=oe;t.default=se}}]);