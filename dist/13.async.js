(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{yfUg:function(e,a,t){"use strict";var r=t("TqRt"),n=t("284h");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("IzEo");var o=r(t("bx4M"));t("OaEy");var l=r(t("2fM7"));t("jCWc");var c=r(t("kPKH"));t("14J3");var i=r(t("BMrR")),d=r(t("lSNA")),s=r(t("lwsE")),f=r(t("W8MJ")),u=r(t("a1gu")),m=r(t("Nsbk")),p=r(t("7W2i"));t("iQDF");var g,y,h=r(t("+eQT")),k=n(t("q1tI")),E=t("MuoO"),v=(t("LLXN"),t("34ay")),S=(r(t("ZhIB")),r(t("4IMT")),r(t("QLqA")),r(t("yt27"))),D=t("4XXU"),b=(t("KTCi"),r(t("v99g"))),C=t("+n12"),I=(0,v.getAuthority)(),x=h.default.RangePicker,A=1e3,B={longRidesScore:{name:"Long Ride Score",intro:"",color:"#ff0400"},pendingReportScore:{name:"Pending Report Score",intro:"",color:"#e68e5c"},onlineVehicleScore:{name:"Online Vehicle Score",intro:"",color:"#16fac5"},lowBatteryVehicleScore:{name:"Low Battery Score",intro:"",color:"#82ca9d"},idleVehicleScore:{name:"Idle Vehicle Score",intro:"",color:"#ffa930"},primeLocationScore:{name:"Prime Location Score",intro:"",color:"#30ff3a"},badLocationScore:{name:"Bad Location Score",intro:"",color:"#30d6db"},operationMarginScore:{name:"Opertation Margin Score",intro:"",color:"#c3c912"},finalScore:{name:"Final Score",intro:"",color:"#3055db"}},O=(g=(0,E.connect)(function(e){var a=e.areas,t=e.performance,r=(e.geo,e.loading);e.chart;return{performance:t,selectedAreaId:a.selectedAreaId,areaNames:a.areaNames,historyDataLoading:r.models.areas||r.effects["performance/historyData"],rankingDataLoading:r.models.areas||r.effects["performance/rankingData"]}}),g(y=function(e){function a(){var e,t;(0,s.default)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t=(0,u.default)(this,(e=(0,m.default)(a)).call.apply(e,[this].concat(n))),t.state={rangePickerValue:(0,C.getTimeDistance)("month"),offset:0,countParams:{filter:"day"},chartType:"summary"},t.handleRangePickerChange=function(e){t.props.dispatch;t.setState({rangePickerValue:e},t.loadData)},t.getFilterContent=function(){var e=t.state,a=e.rangePickerValue;e.areaIsChanged;return k.default.createElement("div",{className:S.default.filterExtraWrap},k.default.createElement(x,{value:a,onChange:t.handleRangePickerChange,style:{width:256}}),k.default.createElement("div",{className:S.default.filterExtra},k.default.createElement("a",{className:t.isActive("week"),onClick:function(){return t.selectDate("week")}},"Week"),k.default.createElement("a",{className:t.isActive("month"),onClick:function(){return t.selectDate("month")}},"Month"),k.default.createElement("a",{className:t.isActive("year"),onClick:function(){return t.selectDate("year")}},"Year")))},t.convertHistoryDataForBar=function(e){var a=t.state.chartType,r=e.map(function(e){return{y:e[a],x:e.period}});return r},t.selectDate=function(e){t.props.dispatch;t.setState({rangePickerValue:(0,C.getTimeDistance)(e)},t.loadData)},t}return(0,p.default)(a,e),(0,f.default)(a,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(e,a,t){e.selectedAreaId!==this.props.selectedAreaId&&this.loadHistoryData()}},{key:"loadData",value:function(){this.loadHistoryData(),this.loadRankingData()}},{key:"loadRankingData",value:function(){var e=this.props,a=e.dispatch,t=e.selectedAreaId,r=this.state,n=r.countParams,o=r.offset,l=r.rangePickerValue;I.includes("get.area.performance.rank")&&a({type:"performance/getRankingData",params:Object.assign({},n,{offset:o,areaId:t>0?t:null,startDate:l[0].toISOString(),endDate:l[1].toISOString(),pageSize:A})})}},{key:"loadHistoryData",value:function(){var e,a=this.props,t=a.dispatch,r=a.selectedAreaId,n=this.state,o=n.countParams,l=n.offset,c=n.rangePickerValue;I.includes("get.area.performance.history")&&t({type:"performance/getHistoryData",params:Object.assign({},o,(e={offset:l,areaIds:r>0?[r]:[],startDate:c[0].toISOString(),endDate:c[1].toISOString()},(0,d.default)(e,"offset",0),(0,d.default)(e,"limit",1e3),e))})}},{key:"isActive",value:function(e){var a=this.state.rangePickerValue,t=(0,C.getTimeDistance)(e);return a[0]&&a[1]&&a[0].isSame(t[0],"day")&&a[1].isSame(t[1],"day")?S.default.currentDate:""}},{key:"render",value:function(){var e=this,a=this.props,t=a.performanceHistoryDataLoading,r=a.performance,n=a.areaNames,d=a.selectedAreaId,s=this.state,f=(s.rangePickerValue,s.areaIsChanged,s.chartType);return k.default.createElement(b.default,null,k.default.createElement(i.default,{gutter:24,style:{marginTop:"2em"}},k.default.createElement(o.default,{loading:t,bordered:!1,bodyStyle:{padding:"2em"}},k.default.createElement(i.default,{style:{paddingBottom:"0.5em",borderBottom:"1px solid #e8e8e8"}},this.getFilterContent()),k.default.createElement(i.default,{style:{marginTop:"0.5em"}},I.includes("get.area.performance.rank")&&k.default.createElement(c.default,{xl:14,lg:12,md:12,sm:24,xs:24},k.default.createElement("div",{className:S.default.scoreBar},k.default.createElement(i.default,null,k.default.createElement(c.default,{xl:12,lg:12,md:12,sm:24,xs:24},k.default.createElement("p",{style:{marginBottom:20,marginLeft:"2em",font:"1.2em bold",color:"black"}},"".concat(d>0?n[d]:"All Area"," Performance By Date"),"  ")),k.default.createElement(c.default,{xl:12,lg:12,md:12,sm:24,xs:24},k.default.createElement(l.default,{defaultValue:"summary",style:{position:"absolute",right:"40px",width:"60%",fontSize:"0.8em"},onChange:function(a){return e.setState({chartType:a})}},Object.keys(B).map(function(e){return k.default.createElement(Option,{key:e,value:e,style:{fontSize:"0.8em"}},B[e].name)}),k.default.createElement(Option,{key:"Summary",value:"summary",style:{fontSize:"0.8em"}},"Summary")))),k.default.createElement(D.ResponsiveContainer,{width:"95%",height:400},k.default.createElement(D.ComposedChart,{data:r.historyData,margin:{top:20,right:30,left:0,bottom:5},stackOffset:"sign"},k.default.createElement(D.CartesianGrid,{strokeDasharray:"3 3"}),k.default.createElement(D.XAxis,{dataKey:"period"}),k.default.createElement(D.YAxis,null),k.default.createElement(D.Tooltip,{formatter:function(e,a,t){return["".concat(Math.round(100*e)/100,"%"),B[a].name]}}),k.default.createElement(D.ReferenceLine,{y:-100,stroke:"#000"}),"summary"===f&&Object.keys(B).map(function(e){if("finalScore"!==e){var a=B[e];return k.default.createElement(D.Bar,{dataKey:e,key:e,stackId:"a",fill:a.color})}}),"summary"!==f&&k.default.createElement(D.Bar,{dataKey:f,key:f,fill:B[f].color}),k.default.createElement(D.Line,{type:"monotone",dataKey:"finalScore",stroke:B.finalScore.color}))))),I.includes("get.area.performance.rank")&&k.default.createElement(c.default,{xl:10,lg:12,md:12,sm:24,xs:24},k.default.createElement("div",{className:S.default.scoreBar},k.default.createElement("h4",{style:{marginBottom:20}}," Ranking "),k.default.createElement("div",{style:{height:400,overflowY:"scroll"}},k.default.createElement(D.ResponsiveContainer,{width:"95%",height:1800},k.default.createElement(D.BarChart,{data:r.rankingData.map(function(e,a){return Object.assign(e,{areaName:"".concat(a+1,". ").concat(n[e.areaId])})}),margin:{top:20,right:30,left:40,bottom:5},stackOffset:"sign",layout:"vertical"},k.default.createElement(D.XAxis,{type:"number",hide:!0}),k.default.createElement(D.YAxis,{type:"category",dataKey:"areaName",tick:{fontWeight:"bold",fontSize:"0.8em"}}),k.default.createElement(D.Tooltip,{formatter:function(e,a,t){return["".concat(Math.round(100*e)/100,"%"),B[a].name]}}),k.default.createElement(D.ReferenceLine,{y:-100,stroke:"#000"}),Object.keys(B).map(function(e){if("finalScore"!==e){var a=B[e];return k.default.createElement(D.Bar,{dataKey:e,key:e,stackId:"a",fill:a.color})}}))))))),k.default.createElement(i.default,{style:{paddingBottom:"1em"}},k.default.createElement(D.ResponsiveContainer,{width:"95%",height:100},k.default.createElement(D.BarChart,{data:r.rankingData.map(function(e,a){return Object.assign(e,{areaName:"".concat(a+1,". ").concat(n[e.areaId])})})},k.default.createElement(D.XAxis,{type:"number",hide:!0}),k.default.createElement(D.YAxis,{type:"category",dataKey:"areaName",tick:{fontWeight:"bold"},hide:!0}),k.default.createElement(D.Tooltip,{formatter:function(e,a,t){return["".concat(Math.round(100*e)/100,"%"),B[a].name]}}),k.default.createElement(D.Legend,{formatter:function(e,a,t){return k.default.createElement("span",null," ",B[e].name," ")}}),Object.keys(B).map(function(e){var a=B[e];return k.default.createElement(D.Bar,{dataKey:e,key:e,stackId:"a",fill:a.color})})))))))}}]),a}(k.Component))||y),R=O;a.default=R},yt27:function(e,a,t){e.exports={scoreCard:"antd-pro-pages-dashboard-performance-scoreCard",scoreBar:"antd-pro-pages-dashboard-performance-scoreBar",filterRank:"antd-pro-pages-dashboard-performance-filterRank",currentDate:"antd-pro-pages-dashboard-performance-currentDate",rankingTitle:"antd-pro-pages-dashboard-performance-rankingTitle",filterCard:"antd-pro-pages-dashboard-performance-filterCard",rankingList:"antd-pro-pages-dashboard-performance-rankingList",filterExtra:"antd-pro-pages-dashboard-performance-filterExtra"}}}]);