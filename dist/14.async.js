(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{"4b56":function(e,t,a){e.exports={tableList:"antd-pro-pages-vehicle-ride-tableList",tableListOperator:"antd-pro-pages-vehicle-ride-tableListOperator",tableListForm:"antd-pro-pages-vehicle-ride-tableListForm",submitButtons:"antd-pro-pages-vehicle-ride-submitButtons"}},BcOJ:function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var d=l(a("pVnL"));a("IzEo");var r=l(a("bx4M"));a("+L6B");var i=l(a("2/Rp"));a("14J3");var s=l(a("BMrR"));a("jCWc");var u=l(a("kPKH")),o=l(a("MVZn"));a("/zsF");var c=l(a("PArb")),f=l(a("lwsE")),m=l(a("W8MJ")),p=l(a("a1gu")),h=l(a("Nsbk")),E=l(a("7W2i"));a("2qtc");var g=l(a("kLXV"));a("giR+");var b=l(a("fyUT"));a("7Kak");var v=l(a("9yH6"));a("OaEy");var y=l(a("2fM7"));a("5NDa");var R=l(a("5rEg"));a("FJo9");var M=l(a("L41K"));a("y8nQ");var S=l(a("Vl3Y"));a("iQDF");var k,V,C,D=l(a("+eQT")),I=n(a("q1tI")),P=a("MuoO"),w=l(a("wd/R")),Y=l(a("CkN6")),H=l(a("zHco")),F=l(a("4b56")),L=a("eHHv"),O=a("PQp+"),x=a("34ay"),T=D.default.RangePicker,z=(0,x.getAuthority)(),N=S.default.Item,U=(M.default.Step,R.default.TextArea,y.default.Option),A=(v.default.Group,["USING","FINISHED"]),G=["GPRS","BLUETOOTH"],W=S.default.create()(function(e){var t=e.isEndRideVisible,a=e.form,l=e.handleEndRide,n=e.handleEndRideVisible,d=e.ride,r=function(){a.validateFields(function(e,t){e||(a.resetFields(),l(d.id,t))})},i=Math.round((new Date-new Date(d.start))/6e4);return I.default.createElement(g.default,{destroyOnClose:!0,title:"End Ride",visible:t,onOk:r,onCancel:function(){return n(!1)}},I.default.createElement(N,{labelCol:{span:5},wrapperCol:{span:15},label:"Minutes"},a.getFieldDecorator("minutes",{initialValue:i})(I.default.createElement(b.default,{placeholder:"Please Input"}))))}),j=(0,L.compose)((0,L.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDPnV_7djRAy8m_RuM5T0QIHU5R-07s3Ic&v=3.exp&libraries=geometry,drawing,places",loadingElement:I.default.createElement("div",{style:{height:"100%"}}),containerElement:I.default.createElement("div",{style:{height:"400px"}}),mapElement:I.default.createElement("div",{style:{height:"100%"}})}),O.withScriptjs,O.withGoogleMap)(function(e){var t=e.path,a=t[Math.round(t.length/2)];return I.default.createElement(O.GoogleMap,{defaultZoom:11,center:a},I.default.createElement(O.Marker,{position:t[0]}),I.default.createElement(O.Marker,{position:t[t.length-1]}),I.default.createElement(O.Polyline,{path:t,geodesic:!0,options:{strokeColor:"#ff0000",strokeOpacity:.75,strokeWeight:2}}))}),B=(k=(0,P.connect)(function(e){var t=e.rides,a=e.areas,l=e.loading;return{rides:t,areas:a.data,selectedAreaId:a.selectedAreaId,loading:l.models.rides}}),V=S.default.create(),k(C=V(C=function(e){function t(){var e,a;(0,f.default)(this,t);for(var l=arguments.length,n=new Array(l),d=0;d<l;d++)n[d]=arguments[d];return a=(0,p.default)(this,(e=(0,h.default)(t)).call.apply(e,[this].concat(n))),a.state={isEndRideVisible:!1,filterCriteria:{currentPage:1,pageSize:10},selectedRecord:null},a.columns=[{title:"Phone",dataIndex:"phone"},{title:"Vehicle Number",dataIndex:"vehicleNumber"},{title:"Lock Way",dataIndex:"lockMethod",render:function(e){return I.default.createElement("span",null,G[e])}},{title:"Unlock Way",dataIndex:"unlockMethod",render:function(e){return I.default.createElement("span",null,G[e])}},{title:"Start",dataIndex:"start",sorter:!0,render:function(e){return I.default.createElement("span",null,(0,w.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{title:"End",dataIndex:"end",sorter:!0,render:function(e){return I.default.createElement("span",null,(0,w.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{title:"operation",render:function(e,t){return I.default.createElement(I.Fragment,null,!t.end&&I.default.createElement("a",{onClick:function(){return a.handleEndRideVisible(!0,t)}},"End Ride"),!t.end&&I.default.createElement(c.default,{type:"vertical"}),I.default.createElement("a",{onClick:function(){return a.handleDetailModalVisible(!0,t)}},"Detail"))}}],a.handleGetRides=function(){var e=a.props.dispatch,t=a.state.filterCriteria;e({type:"rides/get",payload:t})},a.handleStandardTableChange=function(e,t,l){var n=a.props.dispatch,d=a.state.filterCriteria,r=(0,o.default)({},d);r.currentPage=e.current,r.pageSize=e.pageSize,l.field&&(r.sorter="".concat(l.field,"_").concat(l.order)),a.setState({filterCriteria:r}),n({type:"rides/get",payload:r})},a.handleFormReset=function(){var e=a.props,t=e.form,l=(e.dispatch,a.state.filterCriteria);t.resetFields();var n={currentPage:1,pageSize:l.pageSize};a.setState({filterCriteria:n},function(){return a.handleGetRides()})},a.handleSearch=function(e){"object"===typeof e&&e.preventDefault();var t=a.props,l=t.form,n=t.selectedAreaId,d=a.state.filterCriteria;l.validateFields(function(e,t){if(!e){t.timeRange&&(t.rideStart=t.timeRange[0].format("MM-DD-YYYY HH:mm:ss"),t.rideEnd=t.timeRange[1].format("MM-DD-YYYY HH:mm:ss"),t.timeRange=void 0);var l=Object.assign({},d,t,{currentPage:1,pageSize:10,areaId:n});a.setState({filterCriteria:l},function(){return a.handleGetRides()})}})},a.handleUpdateModalVisible=function(e,t){a.setState({updateModalVisible:!!e,selectedRecord:t||{}})},a.handleDetailModalVisible=function(e,t){var l=a.props.dispatch;a.state.filterCriteria;e?z.includes("get.ride.route")?l({type:"rides/getRoute",rideId:t.id,onSuccess:function(e){return a.setState({selectedRidePath:e,detailModalVisible:!0,selectedRecord:t})}}):a.setState({detailModalVisible:!0,selectedRecord:t}):a.setState({detailModalVisible:!1,selectedRecord:null,selectedRidePath:null})},a.handleEndRide=function(e,t){var l=a.props.dispatch;l({type:"rides/endRide",rideId:e,minutes:t,onSuccess:function(){return a.handleGetRides()}}),a.handleEndRideVisible()},a.handleUpdate=function(e,t){var l=a.props.dispatch;l({type:"rides/update",payload:t,id:e,onSuccess:a.handleGetRides}),a.handleUpdateModalVisible()},a.handleEndRideVisible=function(e,t){a.setState({isEndRideVisible:!!e,selectedRecord:t})},a}return(0,E.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){this.handleSearch()}},{key:"componentDidUpdate",value:function(e,t,a){e.selectedAreaId!==this.props.selectedAreaId&&this.handleSearch()}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return I.default.createElement(S.default,{onSubmit:this.handleSearch,layout:"inline"},I.default.createElement(s.default,{gutter:{md:8,lg:24,xl:48}},I.default.createElement(u.default,{md:6,sm:24},I.default.createElement(N,{label:"Keywords"},e("numberOrPhone")(I.default.createElement(R.default,{placeholder:"NUMBER PHONE"})))),I.default.createElement(u.default,{md:6,sm:24},I.default.createElement(N,{label:"Type"},e("type")(I.default.createElement(y.default,{placeholder:"select",style:{width:"100%"}},A.map(function(e,t){return I.default.createElement(U,{key:t,value:t},A[t])}))))),I.default.createElement(u.default,{md:6,sm:24},I.default.createElement(N,{label:"Lock Way"},e("lockWay")(I.default.createElement(y.default,{placeholder:"select",style:{width:"100%"}},G.map(function(e,t){return I.default.createElement(U,{key:t,value:t},G[t])}))))),I.default.createElement(u.default,{md:6,sm:24},I.default.createElement(N,{label:"Unlock Way"},e("unlockWay")(I.default.createElement(y.default,{placeholder:"select",style:{width:"100%"}},G.map(function(e,t){return I.default.createElement(U,{key:t,value:t},G[t])})))))),I.default.createElement(s.default,{gutter:{md:8,lg:24,xl:48}},I.default.createElement(u.default,{md:24,sm:24},I.default.createElement(N,{label:"Time"},e("timeRange")(I.default.createElement(T,{format:"YYYY-MM-DD HH:mm:ss",showTime:!0}))))),I.default.createElement(s.default,{gutter:{md:8,lg:24,xl:48}},I.default.createElement(u.default,{md:{span:8,offset:16},sm:24},I.default.createElement("span",{className:F.default.submitButtons,style:{float:"right"}},I.default.createElement(i.default,{type:"primary",htmlType:"submit"},"Search"),I.default.createElement(i.default,{style:{marginLeft:8},onClick:this.handleFormReset},"Reset")))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.rides,l=(t.areas,t.loading),n=this.state,i=n.isEndRideVisible,s=n.detailModalVisible,u=n.selectedRecord,o=n.filterCriteria,c=n.selectedRidePath,f={handleEndRide:this.handleEndRide,handleEndRideVisible:this.handleEndRideVisible},m={defaultCurrent:1,current:o.currentPage,pageSize:o.pageSize,total:a.total};return I.default.createElement(H.default,{title:"Ride List"},I.default.createElement(r.default,{bordered:!1},I.default.createElement("div",{className:F.default.tableList},I.default.createElement("div",{className:F.default.tableListForm},this.renderSimpleForm()),I.default.createElement(Y.default,{loading:l,data:{list:a.data,pagination:m},columns:this.columns,onChange:this.handleStandardTableChange,scroll:{x:1300}}))),i&&I.default.createElement(W,(0,d.default)({},f,{isEndRideVisible:i,ride:u})),u&&s&&I.default.createElement(g.default,{destroyOnClose:!0,title:"Detail",visible:s,onCancel:function(){return e.handleDetailModalVisible()},onOk:function(){return e.handleDetailModalVisible()}},Object.keys(u).map(function(e){return I.default.createElement("p",{key:e},"".concat(e," : ").concat(u[e]))}),c&&c.length>=2&&I.default.createElement(j,{path:c})))}}]),t}(I.PureComponent))||C)||C),J=B;t.default=J}}]);